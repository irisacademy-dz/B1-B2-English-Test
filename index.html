<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Placement Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        
        h1, h2 {
            color: #2c3e50;
            text-align: center;
        }
        
        .question {
            background-color: #f8f9fa;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        
        .options {
            margin-left: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            cursor: pointer;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box;
        }
        
        textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            box-sizing: border-box;
            margin-top: 10px;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            display: block;
            margin: 20px auto;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        #results {
            background-color: #e8f4fc;
            padding: 20px;
            border-radius: 5px;
            margin-top: 30px;
            display: none;
        }
        
        .result-item {
            margin-bottom: 15px;
        }
        
        .tts-btn {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
            border-radius: 3px;
            margin-left: 10px;
        }
        
        .tts-btn:hover {
            background-color: #27ae60;
        }
    </style>
</head>
<body>
    <h1>English Placement Test</h1>
    <p>This test will help determine your English proficiency level according to the Common European Framework (CEFR).</p>
    
    <form name="placementTest">
        <div class="question">
            <h3>1. Choose the correct option:</h3>
            <p>If I ______ you, I would take the job.</p>
            <div class="options">
                <label><input type="radio" name="q1" value="a"> a) was</label>
                <label><input type="radio" name="q1" value="b"> b) were</label>
                <label><input type="radio" name="q1" value="c"> c) am</label>
                <label><input type="radio" name="q1" value="d"> d) would be</label>
            </div>
        </div>
        
        <div class="question">
            <h3>2. Choose the correct option:</h3>
            <p>By next month, I ______ working here for five years.</p>
            <div class="options">
                <label><input type="radio" name="q2" value="a"> a) will be</label>
                <label><input type="radio" name="q2" value="b"> b) will have been</label>
                <label><input type="radio" name="q2" value="c"> c) am</label>
                <label><input type="radio" name="q2" value="d"> d) have been</label>
            </div>
        </div>
        
        <div class="question">
            <h3>3. Choose the correct option:</h3>
            <p>She suggested ______ to the cinema.</p>
            <div class="options">
                <label><input type="radio" name="q3" value="a"> a) to go</label>
                <label><input type="radio" name="q3" value="b"> b) going</label>
                <label><input type="radio" name="q3" value="c"> c) that we go</label>
                <label><input type="radio" name="q3" value="d"> b) or c)</label>
            </div>
        </div>
        
        <div class="question">
            <h3>4. Choose the correct option:</h3>
            <p>I wish I ______ how to swim when I was younger.</p>
            <div class="options">
                <label><input type="radio" name="q4" value="a"> a) had learned</label>
                <label><input type="radio" name="q4" value="b"> b) learned</label>
                <label><input type="radio" name="q4" value="c"> c) would learn</label>
                <label><input type="radio" name="q4" value="d"> d) have learned</label>
            </div>
        </div>
        
        <div class="question">
            <h3>5. Choose the correct option:</h3>
            <p>The report ______ by the time the meeting starts.</p>
            <div class="options">
                <label><input type="radio" name="q5" value="a"> a) will finish</label>
                <label><input type="radio" name="q5" value="b"> b) will be finished</label>
                <label><input type="radio" name="q5" value="c"> c) will have been finished</label>
                <label><input type="radio" name="q5" value="d"> d) is finishing</label>
            </div>
        </div>
        
        <div class="question">
            <h3>6. Choose the correct option:</h3>
            <p>Hardly ______ when the phone rang.</p>
            <div class="options">
                <label><input type="radio" name="q6" value="a"> a) I had arrived</label>
                <label><input type="radio" name="q6" value="b"> b) had I arrived</label>
                <label><input type="radio" name="q6" value="c"> c) I arrived</label>
                <label><input type="radio" name="q6" value="d"> d) arrived I</label>
            </div>
        </div>
        
        <div class="question">
            <h3>7. Which of these words are countable nouns? (Select all that apply)</h3>
            <div class="options">
                <label><input type="checkbox" name="q7a"> a) information</label>
                <label><input type="checkbox" name="q7b"> b) advice</label>
                <label><input type="checkbox" name="q7c"> c) suggestion</label>
                <label><input type="checkbox" name="q7d"> d) furniture</label>
            </div>
        </div>
        
        <div class="question">
            <h3>8. Choose the correct option:</h3>
            <p>______ I have a word with you?</p>
            <div class="options">
                <label><input type="radio" name="q8" value="a"> a) May</label>
                <label><input type="radio" name="q8" value="b"> b) Might</label>
                <label><input type="radio" name="q8" value="c"> c) Could</label>
                <label><input type="radio" name="q8" value="d"> d) All are correct</label>
            </div>
        </div>
        
        <div class="question">
            <h3>9. Choose the correct option:</h3>
            <p>He denied ______ the money.</p>
            <div class="options">
                <label><input type="radio" name="q9" value="a"> a) to take</label>
                <label><input type="radio" name="q9" value="b"> b) taking</label>
                <label><input type="radio" name="q9" value="c"> c) having taken</label>
                <label><input type="radio" name="q9" value="d"> d) b) or c)</label>
            </div>
        </div>
        
        <div class="question">
            <h3>10. Complete the sentence:</h3>
            <p>She started working here in 2010. <br>
            She ________________ since 2010.</p>
            <input type="text" id="q10">
            <button type="button" class="tts-btn" onclick="speakQuestion(10)">Hear Question</button>
        </div>
        
        <div class="question">
            <h3>11. Complete the sentence:</h3>
            <p>"I'm going to visit my parents tomorrow," she said. <br>
            She said that ________________ tomorrow.</p>
            <input type="text" id="q11">
            <button type="button" class="tts-btn" onclick="speakQuestion(11)">Hear Question</button>
        </div>
        
        <div class="question">
            <h3>12. Write a short essay (100-150 words) on the following topic:</h3>
            <p>"The advantages and disadvantages of living in a big city"</p>
            <textarea id="essay"></textarea>
        </div>
        
        <button type="button" onclick="calculateResults()">Submit Test</button>
    </form>
    
    <div id="results">
        <h2>Test Results</h2>
        <div class="result-item">
            <strong>Score:</strong> <span id="scoreDisplay"></span>/20 (Algerian scale)
        </div>
        <div class="result-item">
            <strong>CEFR Level:</strong> <span id="levelText"></span>
        </div>
        <div class="result-item">
            <strong>Description:</strong> <span id="descriptionText"></span>
        </div>
        <div class="result-item">
            <strong>Feedback (English):</strong> <span id="englishComment"></span>
        </div>
        <div class="result-item">
            <strong>Feedback (French):</strong> <span id="frenchComment"></span>
        </div>
    </div>
    
    <script>
        // Correct answers
        const correctAnswers = {
            q1: "b",
            q2: "b",
            q3: "d",
            q4: "a",
            q5: "c",
            q6: "b",
            q7: ["c"],
            q8: "d",
            q9: "d"
        };
        
        // Text-to-speech function
        function speakQuestion(questionNum) {
            if ('speechSynthesis' in window) {
                const questionText = document.querySelector(`#q${questionNum}`).previousElementSibling.textContent;
                const utterance = new SpeechSynthesisUtterance(questionText);
                utterance.lang = 'en-US';
                speechSynthesis.speak(utterance);
            } else {
                alert("Text-to-speech is not supported in your browser.");
            }
        }
        
        // Helper function to compare arrays
        function arraysEqual(a, b) {
            return a.length === b.length && a.every((val, index) => val === b[index]);
        }
        
        // Get Cambridge level description
        function getCambridgeDescription(level) {
            const descriptions = {
                "A2": "Can understand sentences and frequently used expressions. Can communicate in simple routine tasks.",
                "A2/B1": "Can understand the main points of familiar matters. Can deal with most situations while traveling.",
                "B1": "Can understand the main points of clear standard input. Can produce simple connected text.",
                "B1+": "Can understand the main ideas of complex text. Can interact with some fluency.",
                "B2": "Can understand the main ideas of complex text. Can interact with fluency and spontaneity.",
                "B2 (Strong)": "Can understand a wide range of demanding texts. Can express ideas fluently."
            };
            return descriptions[level] || "";
        }
        
        // Calculate results
        function calculateResults() {
            // Collect student info (could be expanded)
            const studentName = prompt("Please enter your name:");
            if (!studentName) return;
            
            let score = 0;
            const form = document.forms['placementTest'];
            
            // Check multiple choice questions (1-6, 8-9)
            for (let i = 1; i <= 6; i++) {
                const questionName = 'q' + i;
                const selectedOption = form.elements[questionName]?.value;
                
                if (selectedOption === correctAnswers[questionName]) {
                    score++;
                }
            }
            
            // Check questions 8-9
            if (form.elements['q8']?.value === correctAnswers.q8) score++;
            if (form.elements['q9']?.value === correctAnswers.q9) score++;
            
            // Check checkbox question (multiple answers)
            const q7Answers = [];
            if (form.elements['q7a'].checked) q7Answers.push("a");
            if (form.elements['q7b'].checked) q7Answers.push("b");
            if (form.elements['q7c'].checked) q7Answers.push("c");
            if (form.elements['q7d'].checked) q7Answers.push("d");
            
            if (arraysEqual(q7Answers, correctAnswers.q7)) {
                score += 2; // Give 2 points for this question
            }
            
            // Check sentence transformations
            const gapFillAnswers = {
                q10: document.getElementById('q10').value.trim().toLowerCase(),
                q11: document.getElementById('q11').value.trim().toLowerCase()
            };
            
            if (gapFillAnswers.q10.includes("has been") && gapFillAnswers.q10.includes("since")) score++;
            if (gapFillAnswers.q11.includes("said to") && gapFillAnswers.q11.includes("going to")) score++;
            
            // Essay is not automatically scored (would need teacher evaluation)
            // But we'll give 1 point just for attempting it
            const essayText = document.getElementById('essay').value.trim();
            if (essayText.length > 100) score += 1;
            
            // Total possible points is 13 (11 questions, with q7 worth 2 points)
            // Convert to Algerian 20-point scale
            const algerianScore = Math.round((score / 13) * 20);
            
            // Determine level with more accurate thresholds for B1-B2 test
            let level, description, englishFeedback, frenchFeedback;
            
            if (score >= 11) { // 85% or higher (Strong B2)
                level = "B2";
                description = "Upper Intermediate (Strong)";
                englishFeedback = "Excellent! You demonstrate strong B2 level skills. You can understand complex texts and interact with fluency and spontaneity.";
                frenchFeedback = "Excellent! Vous démontrez des compétences solides de niveau B2. Vous pouvez comprendre des textes complexes et interagir avec aisance et spontanéité.";
            } 
            else if (score >= 9) { // 70-84% (B2)
                level = "B2";
                description = "Upper Intermediate";
                englishFeedback = "Good! You demonstrate B2 level skills. You can understand the main ideas of complex text and interact with reasonable fluency.";
                frenchFeedback = "Bien! Vous démontrez des compétences de niveau B2. Vous pouvez comprendre les idées principales de textes complexes et interagir avec une aisance raisonnable.";
            }
            else if (score >= 7) { // 55-69% (B1+)
                level = "B1+";
                description = "Intermediate/Upper Intermediate";
                englishFeedback = "Developing skills. You have good B1 skills approaching B2. You can handle most situations but should work on more complex structures and vocabulary.";
                frenchFeedback = "Compétences en développement. Vous avez de bonnes compétences de niveau B1 approchant le B2. Vous pouvez gérer la plupart des situations mais devriez travailler sur des structures et un vocabulaire plus complexes.";
            }
            else if (score >= 5) { // 40-54% (B1)
                level = "B1";
                description = "Intermediate";
                englishFeedback = "Basic intermediate level. You can understand main points about familiar topics and handle simple conversations, but need more practice with complex language.";
                frenchFeedback = "Niveau intermédiaire de base. Vous pouvez comprendre les points principaux sur des sujets familiers et gérer des conversations simples, mais avez besoin de plus de pratique avec le langage complexe.";
            }
            else if (score >= 3) { // 20-39% (A2/B1)
                level = "A2/B1";
                description = "Elementary to Pre-Intermediate";
                englishFeedback = "Basic proficiency. You can understand basic expressions and communicate in simple routine tasks. Consider focusing on intermediate grammar and vocabulary.";
                frenchFeedback = "Maîtrise de base. Vous pouvez comprendre des expressions de base et communiquer dans des tâches simples et routinières. Envisagez de vous concentrer sur la grammaire et le vocabulaire intermédiaires.";
            }
            else { // Below 20% (A2 or below)
                level = "A2";
                description = "Elementary";
                englishFeedback = "Foundational level. You're at an elementary stage of English. Focus on building basic vocabulary and grammar before tackling intermediate material.";
                frenchFeedback = "Niveau fondamental. Vous êtes au stade élémentaire de l'anglais. Concentrez-vous sur l'acquisition d'un vocabulaire et d'une grammaire de base avant d'aborder du matériel intermédiaire.";
            }
            
            // Display results
            document.getElementById('scoreDisplay').textContent = algerianScore;
            
            document.getElementById('levelText').innerHTML = `
                <span style="font-size: 1.2em; font-weight: bold;">${level}</span><br>
                ${description}
            `;
            
            document.getElementById('descriptionText').innerHTML = `
                ${getCambridgeDescription(level)}
            `;
            
            document.getElementById('englishComment').textContent = englishFeedback;
            document.getElementById('frenchComment').textContent = frenchFeedback;
            
            document.getElementById('results').style.display = 'block';
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth'
            });
        }
    </script>
</body>
</html>
